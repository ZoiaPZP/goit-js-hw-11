{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function service(query, page = 1, perPage = 40) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '48018775-66f870a0a55ddc658d7ca6c06';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  });\n\n  console.log(\"Запит до API:\", `${BASE_URL}?${params}`); \n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    console.log(\"Успішна відповідь від API:\", response.data); \n    return response;\n  } catch (error) {\n    console.error(\"Помилка у запиті API:\", error); \n    throw error;\n  }\n}\n\n\n\n\n\n","export const elem = {\n  form: document.getElementById(\"search-form\"),\n  input: document.querySelector(\".input\"),\n  gallery: document.querySelector(\".gallery\"),\n  loadMoreBtn: document.querySelector(\".load-more\"),\n};\n\nif (!elem.gallery) console.error(\"Gallery not found in the DOM\");\nif (!elem.loadMoreBtn) console.error(\"'Load More' button not found in the DOM\");\nif (!elem.form) console.error(\"Form not found in the DOM\");\nif (!elem.input) console.error(\"Input field not found in the DOM\");\n\nexport function renderMarkup(items, callback) {\n  const gallery = elem.gallery;\n  const markup = items\n    .map(\n      item => `\n        <div class=\"gallery-item hidden\">\n          <a href=\"${item.largeImageURL}\">\n            <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" class=\"gallery-image\" loading=\"lazy\" />\n          </a>\n          <p>${item.tags}</p>\n        </div>\n      `\n    )\n    .join('');\n  gallery.insertAdjacentHTML(\"beforeend\", markup);\n\n  \n  const images = gallery.querySelectorAll(\".gallery-item img\");\n  let loadedCount = 0;\n\n  images.forEach(img => {\n    img.addEventListener(\"load\", () => {\n      loadedCount += 1;\n      if (loadedCount === images.length) {\n        gallery.querySelectorAll(\".hidden\").forEach(item => item.classList.remove(\"hidden\"));\n        if (callback) callback();\n      }\n    });\n  });\n}\n\nexport function clearGallery() {\n  elem.gallery.innerHTML = \"\";\n}\n\n\n\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport Notiflix from \"notiflix\";\nimport \"notiflix/dist/notiflix-3.1.0.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"./css/common.css\";\nimport \"./css/styles.css\";\nimport { service } from \"./js/pixabay-api.js\";\nimport { elem, renderMarkup, clearGallery } from \"./js/render-functions.js\";\n\nlet page = 1;\nconst perPage = 40;\n\n// Showing and hiding the loading indicator\nconst loadingIndicator = document.getElementById(\"loading-indicator\");\nconst showLoadingSpinner = () => (loadingIndicator.style.display = \"block\");\nconst hideLoadingSpinner = () => (loadingIndicator.style.display = \"none\");\n\nconst hideLoadMoreBtn = () => elem?.loadMoreBtn?.classList.add(\"load-more-hidden\");\nconst showLoadMoreBtn = () => elem?.loadMoreBtn?.classList.remove(\"load-more-hidden\");\n\nhideLoadMoreBtn();\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionPosition: \"bottom\",\n  captionDelay: 200,\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  Notiflix.Notify.init({\n    position: \"right-bottom\",\n    clickToClose: true,\n    timeout: 3000,\n  });\n});\n\nasync function submit(evt) {\n  evt.preventDefault();\n  const text = elem.input.value.trim();\n  if (!text) {\n    hideLoadMoreBtn();\n    Notiflix.Notify.failure(\"Please enter a search query.\");\n    return;\n  }\n\n  page = 1;\n  clearGallery();\n  showLoadingSpinner();\n\n  try {\n    const galleryItems = await service(text, page, perPage);\n    if (!galleryItems?.data?.hits?.length) {\n      iziToast.error({ title: \"Error\", message: \"No images found.\" });\n      return;\n    }\n\n    const totalHits = galleryItems.data.totalHits;\n    totalHits > perPage ? showLoadMoreBtn() : hideLoadMoreBtn();\n\n    Notiflix.Notify.success(`Success! Found ${totalHits} images.`);\n    renderMarkup(galleryItems.data.hits, () => lightbox.refresh());\n  } catch (error) {\n    Notiflix.Notify.failure(\"An error occurred. Please try again.\");\n  } finally {\n    hideLoadingSpinner();\n  }\n}\n\nasync function onClickBtn() {\n  page += 1;\n  const text = elem.input.value.trim();\n  showLoadingSpinner();\n\n  try {\n    const galleryItems = await service(text, page, perPage);\n    if (!galleryItems?.data?.hits?.length) {\n      hideLoadMoreBtn();\n      Notiflix.Notify.failure(\"No more results.\");\n      return;\n    }\n\n    renderMarkup(galleryItems.data.hits, () => lightbox.refresh());\n  } catch (error) {\n    Notiflix.Notify.failure(\"An error occurred while loading more images.\");\n  } finally {\n    hideLoadingSpinner();\n  }\n}\n\nif (elem?.form) elem.form.addEventListener(\"submit\", submit);\nif (elem?.loadMoreBtn) elem.loadMoreBtn.addEventListener(\"click\", onClickBtn);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["service","query","page","perPage","BASE_URL","API_KEY","params","response","axios","error","elem","renderMarkup","items","callback","gallery","markup","item","images","loadedCount","img","clearGallery","loadingIndicator","showLoadingSpinner","hideLoadingSpinner","hideLoadMoreBtn","_a","showLoadMoreBtn","lightbox","SimpleLightbox","Notiflix","submit","evt","text","galleryItems","_b","iziToast","totalHits","onClickBtn"],"mappings":"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"}