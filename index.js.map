{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function service(query, page = 1, perPage = 40) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '48018775-66f870a0a55ddc658d7ca6c06';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: perPage,\n  });\n\n  console.log(\"Запит до API:\", `${BASE_URL}?${params}`); \n\n  try {\n    const response = await axios.get(`${BASE_URL}?${params}`);\n    console.log(\"Успішна відповідь від API:\", response.data); \n    return response;\n  } catch (error) {\n    console.error(\"Помилка у запиті API:\", error); \n    throw error;\n  }\n}\n\n\n\n\n\n","export const elem = {\n  galleryDiv: document.querySelector(\".gallery\"),\n  loadMoreBtn: document.querySelector(\".load-more\"),\n  form: document.querySelector(\".search-form\"),\n  input: document.querySelector('.search-form input[name=\"searchQuery\"]'),\n};\n\n\nif (!elem.galleryDiv) console.error(\"Галерея не знайдена в DOM\");\nif (!elem.loadMoreBtn) console.error(\"Кнопка 'Load More' не знайдена в DOM\");\nif (!elem.form) console.error(\"Форма не знайдена в DOM\");\nif (!elem.input) console.error(\"Поле введення не знайдено в DOM\");\n\n\nexport function clearGallery() {\n  elem.galleryDiv.innerHTML = \"\";\n}\n\n\nexport function renderMarkup(img) {\n  elem.galleryDiv.insertAdjacentHTML(\"beforeend\", createMarkup(img));\n}\n\n\nexport function createMarkup(img) {\n  return img\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <div class=\"photo-card\">\n          <a href=\"${largeImageURL}\" class=\"gallery-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n          </a>\n          <div class=\"info\">\n            <p class=\"info-item\"><b>Likes: ${likes}</b></p>\n            <p class=\"info-item\"><b>Views: ${views}</b></p>\n            <p class=\"info-item\"><b>Comments: ${comments}</b></p>\n            <p class=\"info-item\"><b>Downloads: ${downloads}</b></p>\n          </div>\n        </div>\n      `\n    )\n    .join(\"\");\n}\n\n\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport Notiflix from \"notiflix\";\nimport \"notiflix/dist/notiflix-3.1.0.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport \"./css/common.css\";\nimport \"./css/styles.css\";\nimport { service } from \"./js/pixabay-api.js\";\nimport { elem, renderMarkup, clearGallery } from \"./js/render-functions.js\";\n\nlet page = 1;\nconst perPage = 40;\n\nconst loadingSpinner = document.getElementById(\"loading-spinner\");\nconst showLoadingSpinner = () => (loadingSpinner.style.display = \"block\");\nconst hideLoadingSpinner = () => (loadingSpinner.style.display = \"none\");\n\nconst hideLoadMoreBtn = () => {\n  if (elem.loadMoreBtn) {\n    elem.loadMoreBtn.style.display = \"none\";\n  } else {\n    console.warn(\"Елемент loadMoreBtn не знайдено.\");\n  }\n};\nconst showLoadMoreBtn = () => {\n  if (elem.loadMoreBtn) {\n    elem.loadMoreBtn.style.display = \"block\";\n  } else {\n    console.warn(\"Елемент loadMoreBtn не знайдено.\");\n  }\n};\n\nhideLoadMoreBtn();\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionPosition: \"bottom\",\n  captionDelay: 200,\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  if (typeof Notiflix === 'undefined') {\n    console.error(\"Notiflix не завантажено!\");\n  } else {\n    Notiflix.Notify.init({\n      position: 'right-bottom',\n      clickToClose: true,\n      timeout: 3000,\n    });\n    console.log(\"Notiflix завантажено успішно!\");\n  }\n});\n\nasync function submit(evt) {\n  evt.preventDefault();\n  console.log(\"Подія submit викликана.\");\n\n  if (!elem || !elem.input) {\n    console.error(\"Елемент input не знайдено у об'єкті elem.\");\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\"Сталася помилка. Перевірте код.\");\n    }\n    return;\n  }\n\n  const text = elem.input.value.trim();\n  console.log(\"Текст пошуку:\", text);\n\n  if (!text) {\n    hideLoadMoreBtn();\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\"Будь ласка, введіть запит для пошуку.\");\n    }\n    return;\n  }\n\n  page = 1;\n  clearGallery();\n  showLoadingSpinner();\n\n  try {\n    console.log(\"Відправляємо запит до API...\");\n    const galleryItems = await service(text, page, perPage);\n\n    if (!galleryItems?.data?.hits?.length) {\n      iziToast.error({ title: \"Помилка\", message: \"Зображення не знайдено.\" });\n      return;\n    }\n\n    const totalHits = galleryItems.data.totalHits;\n    console.log(\"Знайдено зображень:\", totalHits);\n\n    if (totalHits <= perPage) {\n      hideLoadMoreBtn();\n    } else {\n      showLoadMoreBtn();\n    }\n\n    if (Notiflix.Notify) {\n      Notiflix.Notify.success(`Ура! Знайдено ${totalHits} зображень.`);\n    }\n    renderMarkup(galleryItems.data.hits);\n    lightbox.refresh();\n  } catch (error) {\n    handleApiError(error);\n  } finally {\n    hideLoadingSpinner();\n  }\n}\n\nasync function onClickBtn() {\n  console.log(\"Натиснута кнопка 'Load More'.\");\n\n  page += 1;\n\n  if (!elem || !elem.input) {\n    console.error(\"Елемент input не знайдено у об'єкті elem.\");\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\"Сталася помилка. Перевірте код.\");\n    }\n    return;\n  }\n\n  const text = elem.input.value.trim();\n  console.log(\"Текст пошуку для додаткового завантаження:\", text);\n\n  try {\n    const galleryItems = await service(text, page, perPage);\n\n    if (!galleryItems?.data?.hits?.length) {\n      hideLoadMoreBtn();\n      if (Notiflix.Notify) {\n        Notiflix.Notify.failure(\"Більше результатів немає.\");\n      }\n      return;\n    }\n\n    renderMarkup(galleryItems.data.hits);\n    lightbox.refresh();\n  } catch (error) {\n    handleApiError(error);\n  }\n}\n\nfunction handleApiError(error) {\n  console.error(\"Помилка при виконанні запиту:\", error);\n\n  if (error.response) {\n    console.error(\"Дані відповіді з помилкою:\", error.response.data);\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\n        `Помилка: ${error.response.data?.message || \"Сервер не відповідає.\"}`\n      );\n    }\n  } else if (error.message) {\n    console.error(\"Технічна помилка:\", error.message || error);\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\"Сталася помилка при з'єднанні з сервером.\");\n    }\n  } else {\n    console.error(\"Невідома помилка:\", error);\n    if (Notiflix.Notify) {\n      Notiflix.Notify.failure(\"Невідома помилка.\");\n    }\n  }\n}\n\nif (elem?.form) {\n  elem.form.addEventListener(\"submit\", submit);\n} else {\n  console.error(\"Елемент form не знайдено у об'єкті elem.\");\n}\n\nif (elem?.loadMoreBtn) {\n  elem.loadMoreBtn.addEventListener(\"click\", onClickBtn);\n} else {\n  console.error(\"Елемент loadMoreBtn не знайдено у об'єкті elem.\");\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":["service","query","page","perPage","BASE_URL","API_KEY","params","response","axios","error","elem","clearGallery","renderMarkup","img","createMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadingSpinner","showLoadingSpinner","hideLoadingSpinner","hideLoadMoreBtn","showLoadMoreBtn","lightbox","SimpleLightbox","Notiflix","submit","evt","text","galleryItems","_b","_a","iziToast","totalHits","handleApiError","onClickBtn"],"mappings":"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"}